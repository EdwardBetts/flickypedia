{% extends "base.html" %}

{% block content %}
  {% include "components/header.html" %}

  <details style="background: yellow; padding: 1em;" open>
    <h3>Read Me:</h3>

    <p>
      For each photo, you need to fill in two fields: <strong>Title</strong> and <strong>Short Caption</strong>.
      Wikimedia Commons requires those to be published under a <a href="https://creativecommons.org/public-domain/cc0/">CC0</a> license.
    </p>

    <p>
      We can do the data mapping from Flickr to Wikimedia Commons.
      If you want to see what's happening with that, click the <strong>More Details</strong> tab.
    </p>

    <p>
      And donâ€™t forget, images for Wikimedia Commons must be information, educational, or instructional.
      That means <strong>no selfies or other personal photos like that</strong>.
    </p>
  </details>

  <h3>Prepare {{ selected_photo_ids|length }} photos</h3>

  <style>
    .info {
      display: grid;
      grid-gap: 5px;
      grid-template-columns: 200px auto;
      grid-template-rows: 20px auto auto;
    }

    .from_flickr {
      grid-column: 1 / 2;
      grid-row: 1 / 3;
    }

    .to_wiki {
      grid-column: 2 / 2;
      grid-row: 1 / 3;
    }

    .flickr_info {
      grid-column: 1 / 2;
      grid-row: 2 / 3;
    }

    .flickr_info p:first-child {
      margin-top: 0;
    }

    .wiki_info {
      grid-column: 2 / 2;
      grid-row: 2 / 3;
    }
  </style>

  <form action="" method="post" style="background: yellow;">
    {{ form.hidden_tag() }}

    {{ form.result_filename }}

    <ul class="plain_list">
      {% for field in form %}
        {% if field.id.startswith('photo_') %}
          {% set photo = field.label.text %}

          {% set large_size = photo.sizes | size_at(desired_size='Large') %}
          <img src="{{ large_size.source }}">

          <div class="info">
            <div class="from_flickr">
              From Flickr
            </div>
            <div class="to_wiki">
              To the Wikimedia Commons Entry
            </div>

            <div class="flickr_info">
              <p>
                <strong>By:</strong> <br/>
                {{ photo.owner.realname or photo.owner.username }} <br/>
                {{ photo.license.label }}
              </p>

              <!-- What if the photo is untitled? -->

              <p>
                <strong>Title:</strong> <br/>
                {{ photo.title }}
              </p>
              
              <p>
                <strong>Description:</strong> <br/>
                TODO: Get description
              </p>
            </div>

            <div class="wiki_info">
              <p>
                <strong>By:</strong> <br/>
                {{ photo.owner.realname or photo.owner.username }} <br/>
                {{ photo.license.label }}
              </p>



            </div>
          </div>

          {{ field.label }}
          {{ field }}
        {% endif %}
      {% endfor %}
    </ul>

    <p>{{ form.submit() }}</p>
  </form>
{% endblock %}
